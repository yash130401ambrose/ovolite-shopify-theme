{% liquid
  assign bg_color = section.settings.bg_color | default: '#f6f4ea'
  assign accent_color = section.settings.accent_color | default: '#f3bd2f'
  assign heading_color = section.settings.heading_color | default: '#0d0d0d'
  assign subheading_color = section.settings.subheading_color | default: '#2c2c2c'
  assign note_color = section.settings.note_color | default: '#2f6a3e'
  assign card_bg = section.settings.card_bg | default: '#ffffff'
  assign section_padding_y = section.settings.section_padding_y | default: 80
  assign gap_between_rows = section.settings.row_gap | default: 72
%}

<section
  id="energy-payment-{{ section.id }}"
  class="energy-payment-spotlight"
  style="--ep-bg: {{ bg_color }};
         --ep-accent: {{ accent_color }};
         --ep-heading: {{ heading_color }};
         --ep-subheading: {{ subheading_color }};
         --ep-note: {{ note_color }};
         --ep-card-bg: {{ card_bg }};
         --ep-padding-y: {{ section_padding_y }}px;
         --ep-row-gap: {{ gap_between_rows }}px;"
>
  <div class="ep-wrapper">
    <div class="ep-top">
      <div class="ep-energy">
        {% if section.settings.energy_icon != blank %}
          <div class="ep-energy-icon">
            {{ section.settings.energy_icon | image_url: width: 140 | image_tag: class: 'ep-energy-icon__image', alt: section.settings.energy_heading | escape }}
          </div>
        {% endif %}
        {% if section.settings.energy_heading != blank %}
          <p class="ep-energy__label">{{ section.settings.energy_heading }}</p>
        {% endif %}
        <div class="ep-energy__metrics">
          <div class="ep-energy__metric ep-energy__metric--primary">
            {% if section.settings.energy_primary_value != blank %}
              <span class="ep-energy__metric-number">{{ section.settings.energy_primary_value }}</span>
            {% endif %}
            {% if section.settings.energy_primary_unit != blank %}
              <span class="ep-energy__metric-unit">{{ section.settings.energy_primary_unit }}</span>
            {% endif %}
          </div>
          <span class="ep-energy__metrics-dot">•</span>
          <div class="ep-energy__metric ep-energy__metric--secondary">
            {% if section.settings.energy_secondary_value != blank %}
              <span class="ep-energy__metric-number">{{ section.settings.energy_secondary_value }}</span>
            {% endif %}
            {% if section.settings.energy_secondary_unit != blank %}
              <span class="ep-energy__metric-unit">{{ section.settings.energy_secondary_unit }}</span>
            {% endif %}
          </div>
        </div>
        {% if section.settings.energy_caption != blank %}
          <p class="ep-energy__caption">{{ section.settings.energy_caption }}</p>
        {% endif %}
      </div>

      <div class="ep-nutrition-card">
        {% if section.settings.nutrition_heading != blank %}
          <p class="ep-nutrition-card__heading">{{ section.settings.nutrition_heading }}</p>
        {% endif %}
        <ul class="ep-nutrition-card__list">
          {% for block in section.blocks %}
            {% if block.type == 'metric' %}
              <li class="ep-nutrition-card__item" {{ block.shopify_attributes }}>
                <span class="ep-nutrition-card__label">{{ block.settings.metric_label }}</span>
                <span class="ep-nutrition-card__value">{{ block.settings.metric_value }}</span>
              </li>
            {% endif %}
          {% endfor %}
        </ul>
      </div>
    </div>

    <div class="ep-bottom">
      <div class="ep-tagline">
        {% if section.settings.tagline_primary != blank %}
          <p class="ep-tagline__primary">{{ section.settings.tagline_primary }}</p>
        {% endif %}
        {% if section.settings.tagline_secondary != blank %}
          <p class="ep-tagline__secondary">{{ section.settings.tagline_secondary }}</p>
        {% endif %}
      </div>

      {% if section.settings.note_left != blank %}
        <span class="ep-floating-note ep-floating-note--left">{{ section.settings.note_left }}</span>
      {% endif %}
      {% if section.settings.note_right != blank %}
        <span class="ep-floating-note ep-floating-note--right">{{ section.settings.note_right }}</span>
      {% endif %}

      <div class="ep-payment-logos">
        {% for block in section.blocks %}
          {% if block.type == 'payment_logo' %}
            <div class="ep-payment-logos__item" style="--logo-size: {{ block.settings.logo_size | default: 120 }}px;" {{ block.shopify_attributes }}>
              {% if block.settings.logo_image != blank %}
                {{ block.settings.logo_image | image_url: width: 220 | image_tag: class: 'ep-payment-logos__image', alt: block.settings.logo_alt | default: block.settings.logo_label }}
              {% endif %}
              {% if block.settings.logo_label != blank %}
                <span class="ep-payment-logos__label">{{ block.settings.logo_label }}</span>
              {% endif %}
            </div>
          {% endif %}
        {% endfor %}
      </div>
    </div>
  </div>
</section>

<style>
  #energy-payment-{{ section.id }} {
    background: var(--ep-bg);
    padding: var(--ep-padding-y) clamp(20px, 6vw, 80px);
  }

  #energy-payment-{{ section.id }} .ep-wrapper {
    width: min(1200px, 100%);
    margin: 0 auto;
    display: flex;
    flex-direction: column;
    gap: var(--ep-row-gap);
    position: relative;
  }

  #energy-payment-{{ section.id }} .ep-top {
    display: grid;
    grid-template-columns: minmax(0, 1.4fr) minmax(0, 1fr);
    gap: clamp(32px, 8vw, 80px);
    align-items: stretch;
  }

  #energy-payment-{{ section.id }} .ep-energy {
    position: relative;
    display: flex;
    flex-direction: column;
    gap: clamp(16px, 4vw, 32px);
    color: var(--ep-heading);
  }

  #energy-payment-{{ section.id }} .ep-energy-icon {
    width: clamp(72px, 12vw, 120px);
    height: clamp(72px, 12vw, 120px);
    border-radius: 50%;
    background: #ffffff;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 22px 36px rgba(17, 36, 20, 0.14);
    transform: translateY(clamp(-16px, -2vw, -32px));
  }

  #energy-payment-{{ section.id }} .ep-energy-icon__image {
    width: clamp(40px, 6vw, 72px);
    height: auto;
    object-fit: contain;
  }

  #energy-payment-{{ section.id }} .ep-energy__label {
    font-size: clamp(22px, 3vw, 42px);
    font-weight: 600;
    letter-spacing: 0.12em;
    text-transform: uppercase;
    margin: 0;
    color: var(--ep-heading);
  }

  #energy-payment-{{ section.id }} .ep-energy__metrics {
    display: flex;
    align-items: flex-end;
    gap: clamp(18px, 5vw, 32px);
  }

  #energy-payment-{{ section.id }} .ep-energy__metric {
    display: inline-flex;
    align-items: flex-end;
    gap: clamp(8px, 2vw, 16px);
  }

  #energy-payment-{{ section.id }} .ep-energy__metric-number {
    font-size: clamp(78px, 11.2vw, 136px);
    font-weight: 700;
    letter-spacing: -0.015em;
    color: var(--ep-accent);
    line-height: 0.75;
  }

  #energy-payment-{{ section.id }} .ep-energy__metric--secondary .ep-energy__metric-number {
    color: color-mix(in srgb, var(--ep-heading) 85%, var(--ep-accent) 15%);
  }

  #energy-payment-{{ section.id }} .ep-energy__metric-unit {
    font-size: clamp(26px, 4.4vw, 56px);
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.06em;
    color: var(--ep-heading);
    transform: translateY(clamp(6px, 1.5vw, 12px));
  }

  #energy-payment-{{ section.id }} .ep-energy__metrics-dot {
    font-size: clamp(40px, 6vw, 72px);
    line-height: 1;
    color: var(--ep-heading);
    transform: translateY(clamp(-2px, -0.8vw, -6px));
  }

  #energy-payment-{{ section.id }} .ep-energy__caption {
    margin: 0;
    font-size: clamp(15px, 2.1vw, 22px);
    color: var(--ep-subheading);
    max-width: clamp(280px, 40vw, 420px);
    line-height: 1.4;
  }

  #energy-payment-{{ section.id }} .ep-nutrition-card {
    position: relative;
    border: 1px solid color-mix(in srgb, var(--ep-heading) 16%, transparent);
    border-radius: 12px;
    background: var(--ep-card-bg);
    padding: clamp(18px, 3vw, 28px);
    box-shadow: 0 20px 40px rgba(14, 32, 20, 0.1);
    display: flex;
    flex-direction: column;
    gap: clamp(16px, 3vw, 28px);
  }

  #energy-payment-{{ section.id }} .ep-nutrition-card__heading {
    font-size: clamp(18px, 2.4vw, 24px);
    font-weight: 600;
    margin: 0;
    letter-spacing: 0.08em;
    text-transform: uppercase;
    color: var(--ep-subheading);
  }

  #energy-payment-{{ section.id }} .ep-nutrition-card__list {
    list-style: none;
    margin: 0;
    padding: 0;
    display: flex;
    flex-direction: column;
  }

  #energy-payment-{{ section.id }} .ep-nutrition-card__item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: clamp(16px, 2.1vw, 20px);
    padding: clamp(12px, 2vw, 18px) 0;
    border-top: 1px solid color-mix(in srgb, var(--ep-heading) 15%, transparent);
  }

  #energy-payment-{{ section.id }} .ep-nutrition-card__item:first-child {
    border-top: none;
  }

  #energy-payment-{{ section.id }} .ep-nutrition-card__label {
    font-weight: 500;
    color: var(--ep-heading);
    letter-spacing: 0.08em;
    text-transform: uppercase;
  }

  #energy-payment-{{ section.id }} .ep-nutrition-card__value {
    font-weight: 600;
    color: var(--ep-heading);
  }

  #energy-payment-{{ section.id }} .ep-bottom {
    position: relative;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: clamp(28px, 6vw, 48px);
  }

  #energy-payment-{{ section.id }} .ep-tagline {
    text-align: center;
    max-width: min(720px, 80%);
  }

  #energy-payment-{{ section.id }} .ep-tagline__primary {
    margin: 0;
    font-size: clamp(30px, 6vw, 62px);
    font-weight: 600;
    color: var(--ep-heading);
  }

  #energy-payment-{{ section.id }} .ep-tagline__secondary {
    margin: clamp(12px, 2vw, 18px) 0 0;
    font-size: clamp(22px, 4vw, 42px);
    font-weight: 600;
    color: color-mix(in srgb, var(--ep-heading) 70%, #ffffff 30%);
  }

  #energy-payment-{{ section.id }} .ep-floating-note {
    position: absolute;
    font-size: clamp(14px, 3vw, 24px);
    font-weight: 500;
    color: var(--ep-note);
    font-family: 'Handlee', 'Comic Sans MS', cursive;
    white-space: pre-line;
    line-height: 1.3;
  }

  #energy-payment-{{ section.id }} .ep-floating-note--left {
    top: clamp(-12px, -4vw, -24px);
    left: clamp(0px, 8vw, 160px);
  }

  #energy-payment-{{ section.id }} .ep-floating-note--right {
    bottom: clamp(-24px, -5vw, -40px);
    right: clamp(0px, 6vw, 140px);
    text-align: right;
  }

  #energy-payment-{{ section.id }} .ep-payment-logos {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: clamp(16px, 4vw, 36px);
    width: 100%;
  }

  #energy-payment-{{ section.id }} .ep-payment-logos__item {
    width: var(--logo-size, 120px);
    height: var(--logo-size, 120px);
    border-radius: 50%;
    background: #ffffff;
    box-shadow: 0 14px 26px rgba(22, 26, 20, 0.12);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 10px;
    padding: 16px;
    text-align: center;
  }

  #energy-payment-{{ section.id }} .ep-payment-logos__image {
    width: clamp(40px, 6vw, 72px);
    height: auto;
    object-fit: contain;
  }

  #energy-payment-{{ section.id }} .ep-payment-logos__label {
    font-size: clamp(13px, 2.8vw, 16px);
    font-weight: 600;
    color: var(--ep-heading);
  }

  #energy-payment-{{ section.id }} .ep-floating-note:empty,
  #energy-payment-{{ section.id }} .ep-tagline__primary:empty,
  #energy-payment-{{ section.id }} .ep-tagline__secondary:empty {
    display: none;
  }

  #energy-payment-{{ section.id }} .ep-payment-logos__item:nth-child(odd) {
    transform: translateY(clamp(-8px, -1.6vw, -18px));
  }

  #energy-payment-{{ section.id }} .ep-payment-logos__item:nth-child(even) {
    transform: translateY(clamp(8px, 1.6vw, 18px));
  }

  @media (max-width: 1024px) {
    #energy-payment-{{ section.id }} .ep-wrapper {
      gap: clamp(48px, 10vw, 68px);
    }

    #energy-payment-{{ section.id }} .ep-top {
      grid-template-columns: 1fr;
    }

    #energy-payment-{{ section.id }} .ep-nutrition-card {
      max-width: 480px;
      margin: 0 auto;
    }
  }

  @media (max-width: 768px) {
    #energy-payment-{{ section.id }} {
      padding: clamp(48px, 18vw, 72px) clamp(16px, 6vw, 36px);
    }

    #energy-payment-{{ section.id }} .ep-floating-note--left {
      left: clamp(-12px, 2vw, 48px);
      top: clamp(-16px, -6vw, -36px);
    }

    #energy-payment-{{ section.id }} .ep-floating-note--right {
      right: clamp(-20px, 4vw, 60px);
      bottom: clamp(-32px, -8vw, -52px);
    }

    #energy-payment-{{ section.id }} .ep-payment-logos__item {
      width: var(--logo-size, 104px);
      height: var(--logo-size, 104px);
    }
  }

  @media (max-width: 520px) {
    #energy-payment-{{ section.id }} .ep-payment-logos__item {
      width: var(--logo-size, 92px);
      height: var(--logo-size, 92px);
      padding: 12px;
    }

    #energy-payment-{{ section.id }} .ep-energy__metric-number {
      font-size: clamp(50px, 17vw, 108px);
    }

    #energy-payment-{{ section.id }} .ep-energy__metric-unit {
      font-size: clamp(22px, 8vw, 40px);
    }
  }
</style>

{% schema %}
{
  "name": "Ingrediant box",
  "tag": "section",
  "class": "section",
  "settings": [
    { "type": "color", "id": "bg_color", "label": "Background color", "default": "#f6f4ea" },
    { "type": "color", "id": "accent_color", "label": "Accent color", "default": "#f3bd2f" },
    { "type": "color", "id": "heading_color", "label": "Primary text color", "default": "#191919" },
    { "type": "color", "id": "subheading_color", "label": "Secondary text color", "default": "#2e332e" },
    { "type": "color", "id": "note_color", "label": "Floating note color", "default": "#34693a" },
    { "type": "color", "id": "card_bg", "label": "Card background color", "default": "#ffffff" },
    { "type": "range", "id": "section_padding_y", "label": "Section vertical padding", "min": 32, "max": 240, "step": 4, "default": 96, "unit": "px" },
    { "type": "range", "id": "row_gap", "label": "Gap between top and bottom blocks", "min": 32, "max": 160, "step": 4, "default": 72, "unit": "px" },

    { "type": "image_picker", "id": "energy_icon", "label": "Energy icon" },
    { "type": "text", "id": "energy_heading", "label": "Energy heading", "default": "ENERGY VALUE" },
    { "type": "text", "id": "energy_primary_value", "label": "Primary value (e.g. 632)", "default": "632" },
    { "type": "text", "id": "energy_primary_unit", "label": "Primary unit (e.g. kJ)", "default": "kJ" },
    { "type": "text", "id": "energy_secondary_value", "label": "Secondary value (e.g. 151)", "default": "151" },
    { "type": "text", "id": "energy_secondary_unit", "label": "Secondary unit (e.g. KCAL)", "default": "kcal" },
    { "type": "textarea", "id": "energy_caption", "label": "Energy caption", "default": "With glucomannan – clinically proven to support weight loss, ideal for your conscious lifestyle." },

    { "type": "text", "id": "nutrition_heading", "label": "Nutrition card heading", "default": "MACROS" },

    { "type": "text", "id": "tagline_primary", "label": "Tagline primary", "default": "Don’t just crave it." },
    { "type": "text", "id": "tagline_secondary", "label": "Tagline secondary", "default": "Get it." },
    { "type": "textarea", "id": "note_left", "label": "Floating note (left)", "default": "3–5 Days\nDelivery" },
    { "type": "textarea", "id": "note_right", "label": "Floating note (right)", "default": "Free Shipping over\n£40.00" }
  ],
  "blocks": [
    {
      "type": "metric",
      "name": "Nutrition metric",
      "settings": [
        { "type": "text", "id": "metric_label", "label": "Metric label", "default": "Fat" },
        { "type": "text", "id": "metric_value", "label": "Metric value", "default": "10.2 g" }
      ]
    },
    {
      "type": "payment_logo",
      "name": "Payment logo",
      "settings": [
        { "type": "image_picker", "id": "logo_image", "label": "Logo image" },
        { "type": "text", "id": "logo_label", "label": "Logo label" },
        { "type": "text", "id": "logo_alt", "label": "Logo alt text" },
        { "type": "range", "id": "logo_size", "label": "Logo circle size", "min": 64, "max": 200, "step": 4, "default": 128, "unit": "px" }
      ]
    }
  ],
  "max_blocks": 16,
  "presets": [
    {
      "name": "Ingrediant box",
      "blocks": [
        { "type": "metric" },
        { "type": "metric" },
        { "type": "metric" },
        { "type": "payment_logo" },
        { "type": "payment_logo" },
        { "type": "payment_logo" },
        { "type": "payment_logo" }
      ]
    }
  ]
}
{% endschema %}

